# ConsoleTransitionsDataByLAN

Проекты для передачи файлов по локальной сети меж `Producer` и `Consumer` с использованием TCP-соединения. Реализована проверка целостности данных с помощью хеширования (SHA256) и подтверждение получения пакетов (ACK/NACK).

Проект для передачи файлов по локальной сети между `TCPServerPoint`'s с использованием TCP-соединения. Реализована проверка целостности данных с помощью хеширования (SHA256) и подтверждение получения пакетов (ACK/NACK).

## Описание проекта

Проект состоит из двух основных компонентов:
1. **TCPServerPoint** - композитная часть, принимающая/отпарвляющая файлы и обрабатывающая/отпарвляющая команды
1. **Producer (TCPProducer)** - отправляет файл частями (чанками) по сети.
2. **Consumer (TCPConsumer)** - принимает файл, проверяет целостность данных и сохраняет его на диск.
4. **UDPCommandWatchers** - обработчик UDP-команд для управления сервером

### Особенности:
- Разбиение файла на чанки фиксированного размера (по умолчанию 1 МБ).
- Проверка целостности данных с помощью SHA256.
- Подтверждение получения пакетов (ACK/NACK) для обеспечения надежности передачи.
- Автоматическое переименование файла при конфликте имен.
- Поддержка множества одновременных подключений
- Командный интерфейс для управления сервером
- UDP-команды для удаленного управления

## Настройка

### Конфигурация Producer
Настройки **Producer** задаются в файле `App.config`:
```xml
<configuration>
  <appSettings>
    <add key="consumerIp" value="IP_адрес_получателя"/>
    <add key="consumerPort" value="Порт_получателя"/>
    <add key="loadFilePath" value="Путь_к_отправляемому_файлу"/>
  </appSettings>
</configuration>
```

### Конфигурация Consumer
Настройки **Consumer** задаются в файле `App.config`:

```xml
<configuration>
  <appSettings>
    <add key="port" value="Порт_для_прослушивания"/>
    <add key="saveDirectoryPath" value="Путь_для_сохранения_файлов"/>
  </appSettings>
</configuration>
```

## Настройка

### Конфигурация сервера (TCPServerPoint)
Настройки задаются в файле `App.config`:
```xml
<configuration>
  <appSettings>
    <add key="port" value="48654" />
    <add key="saveDirectoryPath" value="C:\Users\pops\Downloads\" />

    <add key="consumerIp" value="192.168.1.11" />
    <add key="consumerPort" value="48654" />
  </appSettings>
</configuration>

## Запуск

Соберите решение
```bash
dotnet publish -c Release -r win-x64 --self-contained true /p:PublishSingleFile=true
``` 

### Запуск Consumer
Соберите проект `Consumer`. 
Запустите исполняемый файл. `Consumer` начнет прослушивать указанный порт.  

### Запуск Producer
Соберите проект `Producer`.  
Запустите исполняемый файл. `Producer` подключится к `Consumer` и начнет передачу файла.

### Запуск TCPServerPoint
Соберите проект `TCPServerPoint`.  
Запустите исполняемый файл. `TCPServerPoint`. используйте команды

### Доступные команды сервера:
- **`takeL`** - получить список доступных файлов
- **`takeF_имя_файла`** - запросить конкретный файл
- **`ping`** - проверить доступность сервера
- **`help`** - справка по командам
- **`exit`** - завершить работу сервера

## Логирование
Оба компонента выводят в консоль информацию о процессе передачи:
- ID чанка.
- Размер чанка.
- Статус передачи (успешно/ошибка).
- Общий размер переданных данных.

## Пример работы `Consumer`+`Producer`
*пункты 1 и 2 можно менять местами*
1. `Consumer` запущен и ожидает подключения.
2. `Producer` пробует подключится к `Consumer` и при успехе начинает передачу файла.
3. `Consumer` принимает чанки, проверяет их целостность и отправляет подтверждение (ACK) или запрос на повторную отправку (NACK).
4. После успешной передачи всего файла, `Consumer` сохраняет его на диск и закрывает соединение.

## Пример работы `TCPServerPoint`
1. Клиент отправляет команду `takeL` для получения списка доступных файлов
2. Сервер формирует список и отправляет его через `TCPProducer`
3. Клиент выбирает нужный файл и отправляет команду `takeF_имя_файла`
4. Сервер начинает передачу файла через TCP
5. Клиент получает файл, проверяет целостность и сохраняет на диск